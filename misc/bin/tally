#!/usr/bin/perl
use strict;
use warnings;

die "usage: rate logfile\n" unless @ARGV == 2;
my ($rate, $fname) = @ARGV;

my $minutes = 0;
open IN, $fname or die "cannot open $fname: $!\n";
while (<IN>) {
	last if /^__END__/;
    chomp;
    next if /^\s/ || /^year/;
    s/^\w+\s\d+\s*//;
    next unless /^\d/;
    for my $range (split /\s*,\s*/) {
        my ($start, $end) = split /-/, $range;
        my ($sh, $sm) = split /:/, $start;
        my ($eh, $em) = split /:/, $end;
        $eh += 12 if $eh < $sh;
        $minutes += ($eh*60+$em) - ($sh*60+$sm);
    }
}
close IN;
my $hours = $minutes/60;
printf "%.5f hours at \$$rate per hour = \$%.2f\n",
       $hours, $hours*$rate;

<html>
<head> <title>MMC's Program Registration Form</title>
<script language="JavaScript" type="text/JavaScript">
function MM_openBrWindow(theURL,winName,features) { //v2.0
  window.open(theURL,winName,features);
}
</script>
<SCRIPT TYPE="text/javascript" src="http://www.mountmadonna.org/onlinereg/formval.js">
</SCRIPT>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<NOSCRIPT>
<P>
Javascript is not currently enabled on your browser.
If you can enable it, your input will be checked as you
enter it (on most browsers, at least).
You may find this helpful.
</P>
</NOSCRIPT>

<SCRIPT TYPE="text/javascript">
//
// Only script specific to this form goes here.
// General-purpose routines are in a separate file.
//
function validateOnSubmit() {
    var errs = 0;
    var alert_msg = "";

    // execute all element validations in reverse order, so focus gets
    // set to the first one in error.

    var got_house1 = false;
    var got_house2 = false;
    for (i = 0; i < document.forms.reg.house1.length; ++i) {
        if (document.forms.reg.house1[i].checked == true) {
            got_house1 = true;
        }
        if (document.forms.reg.house2[i].checked == true) {
            got_house2 = true;
        }
    }
    if (!got_house1) {
        alert_msg = alert_msg + "No first housing choice made.\n";
        errs += 1;
    }
    if (!got_house2) {
        alert_msg = alert_msg + "No second housing choice made.\n";
        errs +=1;
    }
    var got_mailings = false;
    for (i = 0; i < document.forms.reg.mailings.length; ++i) {
        if (document.forms.reg.mailings[i].checked == true) {
            got_mailings = true;
        }
    }
    if (!got_mailings) {
        alert_msg = alert_msg + "Shall we send you announcements?\n";
        msg('msg_mailings', 'error', 'ERROR: required');
        document.forms.reg.mailings[0].focus();	// doesn't always work
                                                // like in Safari e.g.
        errs += 1;
    }
    if (!validateEmail(document.forms.reg.email2, 'msg_email2', true))
        errs += 1;
    if (!validateEmail(document.forms.reg.email1, 'msg_email1', true))
        errs += 1;
    if (document.forms.reg.email1.value != document.forms.reg.email2.value) {
        alert_msg = alert_msg + "The email addresses do not match.\n";
        document.forms.reg.email2.focus();
        errs += 1;
    }
    var empty = /^\s*$/;
    if (empty.test(document.forms.reg.ephone.value) &&
        empty.test(document.forms.reg.dphone.value)) {
        alert_msg = alert_msg + "Please give either a home or a work " +
                                "telephone number.\n";
        document.forms.reg.dphone.focus();
        msg('msg_ephone', 'error', 'Home or work phone is required.');
        errs += 1;
    }
    if (!validatePresent(document.forms.reg.zip,  'msg_zip'))
        errs += 1;
    if (!validatePresent(document.forms.reg.state,  'msg_state'))
        errs += 1;
    if (!validatePresent(document.forms.reg.city,  'msg_city'))
        errs += 1;
    if (!validatePresent(document.forms.reg.street1,  'msg_street1'))
        errs += 1;
    var got_gender = false;
    for (i = 0; i < document.forms.reg.gender.length; ++i) {
        if (document.forms.reg.gender[i].checked == true) {
            got_gender = true;
        }
    }
    if (!got_gender) {
        alert_msg = alert_msg + "Male or female?\n";
        msg('msg_gender', 'error', 'ERROR: required');
        document.forms.reg.gender[0].focus();	// doesn't always work
                                                // like in Safari e.g.
        errs += 1;
    }
    if (!validatePresent(document.forms.reg.lname,  'msg_lname'))
        errs += 1;
    if (!validatePresent(document.forms.reg.fname,  'msg_fname'))
        errs += 1;
    //
    // was there a choice of program length?
    //
    var got_basic_full = true;
    if (document.forms.reg.progchoice.length == 2) {
	got_basic_full = false;
        for (i = 0; i < document.forms.reg.progchoice.length; ++i) {
            if (document.forms.reg.progchoice[i].checked == true) {
                got_basic_full = true;
            }
        }
    }
    if (!got_basic_full) {
        alert_msg +=
        "Please indicate how many days you would like to attend this program.\n";
        document.forms.reg.progchoice[0].focus();
        errs += 1;
    }
    if (alert_msg != "")
        alert(alert_msg);
    return (errs == 0);
}
</SCRIPT>
<STYLE TYPE="text/css">
@import url("http://www.mountmadonna.org/onlinereg/formval.css");
</STYLE>
<link href="http://www.mountmadonna.org/mmc.css"
      rel="stylesheet"
      type="text/css"
>
<style>
body {
	background-color: ivory;
    margin-left: 30px;
}
.style5 {
	color: #FF0000;
	font-size: 15pt;
	line-height: 140%;
}
</style>
</head>
<body>
<img src="/Gif/navbar_home.gif" align=middle>
<font size=+3>Mount Madonna Center Online Registration</font>
<p>
<form name=reg action="/cgi-bin/dreg2" method="POST"
      onsubmit="return validateOnSubmit()">
<input type=hidden name=test value='ZZtestZZ'>
<input type=hidden name=dir value='ZZdirZZ'>
<h1>Step 1: Registration Form</h1>
<ul>
<li>
<b>Fill out</b> this form.<br>
You must fill out a separate registration form for each person
attending a program.<br>
Fields marked with an asterisk <span class="required">*</span> are required.
<p>
<li><b>Click on</b> the <b>&quot;Continue&quot;</b>
 button at the bottom of the page.
</ul>
<h2>You are registering for:</h2>
<ul>
ZZregisterForZZ
</ul>
<P>
ZZprogchoiceZZ

<h2>Personal Info</h2>

<table cellspacing=2>

<tr>
<td align=right><span class="required">*</span> First Name</td>
<td>
<input type=text name=fname value="ZZfnameZZ" size=15 maxlength=15
       onchange="validatePresent(this, 'msg_fname');"></td>
<td id=msg_fname></td>
</tr>

<tr>
<td align=right><span class="required">*</span> Last Name</td>
<td><input type=text name=lname value="ZZlnameZZ" size=15 maxlength=15
       onchange="validatePresent(this, 'msg_lname');"></td>
<td id=msg_lname></td>
</tr>

<tr>
<td align=right valign=top><span class="required">*</span> Gender</td>
<td>
<input type=radio name="gender" ZZmaleZZ value="male"
       onclick="msg('msg_gender', 'info', '');"> Male<br>
<input type=radio name="gender" ZZfemaleZZ value="female"
       onclick="msg('msg_gender', 'info', '');"> Female<br>
</td>
<td id=msg_gender></td>
</tr>

<tr>
<td align=right><span class="required">*</span> Street</td>
<td><input type=text name=street1 value="ZZstreet1ZZ" size=30 maxlength=30
       onchange="validatePresent(this, 'msg_street1');"></td>
</tr>

<tr>
<td>&nbsp;</td>
<td><input type=text name=street2 value="ZZstreet2ZZ" size=30 maxlength=30></td>
<td>&nbsp;</td>
</tr>

<tr>
<td align=right><span class="required">*</span> City</td>
<td><input type=text name=city value="ZZcityZZ" size=24 maxlength=24
       onchange="validatePresent(this, 'msg_city');"></td>
<td id=msg_city></td>
</tr>

<tr>
<td align=right><span class="required">*</span> State/Province</td>
<td><input type=text name=state value="ZZstateZZ" size=5 maxlength=5
       onchange="validatePresent(this, 'msg_state');"></td>
<td id=msg_state></td>
</tr>

<tr>
<td align=right><span class="required">*</span> Zip/Postal Code</td>
<td><input type=text name=zip value="ZZzipZZ" size=7 maxlength=7
       onchange="validatePresent(this, 'msg_zip');"></td>
<td id=msg_zip></td>
</tr>

<tr>
<td align=right>Country</td>
<td><input type=text name=country value="ZZcountryZZ" size=20 maxlength=20
       onchange="validatePresent(this, 'msg_country');"></td>
<td id=msg_country>Defaults to USA.</td>
</tr>

<tr>
<td align=right><span class="required">*</span> Home Phone</td>
<td><input type=text name=ephone value="ZZephoneZZ" size=20 maxlength=20>
</td>
<td id=msg_ephone>Home or Work phone is required.</td>
</tr>

<tr>
<td align=right>Work Phone</td>
<td><input type=text name=dphone value="ZZdphoneZZ" size=20 maxlength=20>
</td>
<td id=msg_dphone>&nbsp;</td>
</tr>

<tr>
<td align=right>&nbsp; Cell Phone</td>
<td><input type=text name=cphone value="ZZcphoneZZ" size=20 maxlength=20>
</td>
<td id=msg_cphone>&nbsp;</td>
</tr>

<tr>
<td align=right><span class="required">*</span> Email</td>
<td><input type=text name=email1 value="ZZemail1ZZ" size=40 maxlength=40
    onchange="validateEmail(document.forms.reg.email1, 'msg_email1', false)"></td>
<td id=msg_email1></td>
</tr>

<tr>
<td align=right><span class="required">*</span> Email Again</td>
<td><input type=text name=email2 value="ZZemail2ZZ" size=40 maxlength=40
    onchange="validateEmail(document.forms.reg.email2, 'msg_email2', false)"></td>
<td id=msg_email2>Repeated to be sure it is right.</td>
</tr>

<tr><td colspan=3>&nbsp;</td></tr>
ZZceuZZ
<tr><td colspan=3 align=left>
Carpooling
</td></tr>

<tr><td>&nbsp;</td><td>
<input type=checkbox name=carpool value=yes ZZcarpoolZZ> I wish to carpool.
</td></tr>
<tr><td>&nbsp;</td><td>
<input type=checkbox name=hascar value=yes ZZhascarZZ> I can drive.
</td></tr>

<tr><td colspan=3>&nbsp;</td></tr>
<tr><td colspan=3 align=left>
How did you first hear about this program?
</td></tr>

<tr><td>&nbsp;</td><td>
<input type=radio name=howHeard
value=ad>Advertisement in <input name=advertiserName type=text size=15 maxlength=15>
</td></tr>
<tr><td>&nbsp;</td><td>
<input type=radio name=howHeard value=web>Web<br>
</td></tr>
<tr><td>&nbsp;</td><td>
<input type=radio name=howHeard value=brochure>MMC Program Brochure<br>
</td></tr>
<tr><td>&nbsp;</td><td>
<input type=radio name=howHeard value=flyer>A Flyer<br>
</td></tr>

<tr><td colspan=3>&nbsp;</td></tr>
<tr>
<td colspan=3 align=left>
<span class="required">*</span> Shall we keep you informed of
events at Mount Madonna Center?
</td>
</tr>

<tr><td>&nbsp;</td><td>
<input type=checkbox name=e_mailings value=yes ZZe_mailingsZZ> Email
</td><td id=msg_mailings>Please indicate your preference.</td>
</tr>

<tr><td>&nbsp;</td><td>
<input type=checkbox name=snail_mailings value=yes ZZsnail_mailingsZZ> Snail Mail
</td></tr>

<tr><td>&nbsp;</td><td>
<input type=checkbox name=share_mailings value=yes ZZshare_mailingsZZ> Share my address with MMC affiliates.
</td></tr>

</table>


<h2>Housing Choices</h2>
<span class="required">*</span> Please indicate your first and second choices
for housing.<br>
&nbsp;&nbsp;&nbsp;If you have a physical disability that limits where you can
be housed, please note this in &ldquo;Additional Requests&rdquo; below.
ZZhousingZZ
If you wish to share a room with someone, put their name here:
<ul>
First <input type=text name="withwhom_first" value='ZZwithwhom_firstZZ' size=15 maxlength=31>
Last <input type=text name="withwhom_last" value='ZZwithwhom_lastZZ' size=15 maxlength=31>
</ul>
<b>and</b> make sure that they register <i>separately</i>.
<p>
<p>
If you have requested a double without a bath there is a further choice.<br>
Would you prefer a cabin or a room?&nbsp;&nbsp;&nbsp;
<a href='/programs/cabins_vs_rooms.html' target=_blank>What's the difference?</a>
<ul>
<input type=radio name=cabinRoom value=cabin ZZcabinZZ> Cabin - heat and electricity, but no indoor plumbing<br>
<input type=radio name=cabinRoom value=room ZZroomZZ> Room
</ul>
<h2>Additional Requests</h2>
<p>
<textarea name="request" rows=10 cols=70 wrap=VIRTUAL></textarea>
<p>
<table width=610><tr><td>
Balance is due on arrival (Visa, MasterCard, cash or check only).
<p>
ZZcanpolZZ
<p>
<i>
Note: This form does not automatically reserve your spot for the program.
You are not registered until we receive your deposit. If the program is full,
your deposit will be refunded.</i>
<p class="style5">
Housing is not always available. Do not finalize your travel plans<br>
until you have received a <strong>housing confirmation</strong>
from Mount Madonna Center.
</td></tr></table>
<input type=hidden value="ZZdescZZ" name=desc>
<input type=hidden value="ZZdatesZZ" name=dates>
<input type=hidden value="ZZleadersZZ" name=leaders>
<input type=hidden value="ZZpnameZZ" name=pname>
<input type=hidden value="ZZpidZZ" name=pid>
<ul>
<input type="submit" name="Submit" value="Continue">
&nbsp; &nbsp; &nbsp; &nbsp;
 <input type="reset" value="Reset Form">
</ul>
</form>
</body>
</html>

<html>
<head>
<meta charset='UTF-8'>
<link rel="stylesheet" type="text/css" href="help.css" />
<style>
.special {
    color: red;
}
</style>
</head>
<body>
<h1>Styling the Reg Scripts on the Web Site</h1>

<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/style'>Toggle the Styling between plain and fancy</a>

<h2>Commands for login 'enio'</h2>
    % tt2 - change into the /var/www/src/cgi-bin/new_tt2 directory<br>
    % ec - edit the new_cgi.css file<br>
    % ej - edit the app.js file

<h2>Including header, footer, top_css_js files</h2>

    [% INCLUDE new_tt2/top_css_js.tt2 %]<br>
    [% INCLUDE new_tt2/header.tt2 %]<br>
    [% INCLUDE new_tt2/footer.tt2 %]

<h2>Examples of Template Toolkit syntax</h2>
    Be careful to NOT alter these things!<br>
    Dollar signs and [% %] are special syntax.
    <p>
    <h3>Interpolation</h3>
    <pre>
    Date: ${sdate.format("%A, %B %e, %Y")}
    Meals: $meals
    Activities: $activities
    </pre>
    <h3>Conditionals</h3>
    <pre>
    [% IF tuition_rolled %]
        A $tuition_name charge of \$$tuition is <i>included</i>
        in the total fees.
    [% ELSIF basicfull %]
        A $tuition_name charge of \$$tuition
        (or \$$full_tuition for $fdays days) will be added.
    [% ELSE %]
        A $tuition_name charge of \$$tuition will be added.
    [% END %]
    </pre>
    <h3>Looping</h3>
    <pre>
    [% cl_row = 'even' %]
    [% FOR r IN housing_fee_rows %]
        &lt;tr class=$cl_row&gt;
        &lt;td&gt;&lt;input type=radio name=house1 value='$r.type' $r.checked1&gt;&lt;/td&gt;
        &lt;td&gt;&lt;input type=radio name=house2 value='$r.type' $r.checked2&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href="javascript:popup('/cgi-bin/show_ht/${r.type}/$r.cost/$housecost_type',650,500)"&gt;$r.short_desc&lt;/a&gt;&lt;/td&gt;
        &lt;td align=right&gt;$r.cost&lt;/td&gt;
        &lt;/tr&gt;
        [% IF cl_row == 'even' %]
            [% cl_row = 'odd' %]
        [% ELSE %]
            [% cl_row = 'even' %]
        [% END %]
    [% END %]
    </pre>

<p>
Note that the suffix .tt2 is used because this is the 2nd version of
the Template Toolkit.

<h2>Special Templates</h2>
There are many templates in the new_tt2 directory.
<p>
The following templates will probably not be styled in the 'standard'
header/footer way.  They are not the typical static html that the new
site is largely composed of.  They are either simple error messages,
or responses to a request or payment, or email messages, or are included
in other templates, or some other reason.   I don't know how you might
want to style them or if they even need to be styled at all.
In the sections below I have marked these templates with <span class=special>**</span>.
<pre>
    err.tt2
    covid_thanks.tt2
    gift_card_message.tt2
    meal_request_receipt.tt2
    member_message.tt2
    mlist_msg.tt2
    mr_err.tt2
    need_email.tt2
    new_hfs_member.tt2
    new_hfs_member2.tt2
    new_hfs_email.tt2
    member_msg.tt2
    program_inquiry2.tt2
    program_inquiry3.tt2
    ram_conflict.tt2
    reg_message.tt2
    rental_payment_message.tt2
    req_pay_message.tt2
    update.tt2
    update2.tt2
    grid_htype.tt2
    kayakalpa.tt2
    kayakalpa2.tt2
    sutra.tt2
</pre>

<h2>Credit Card Payments with Stripe OR NOT</h2>
The full thorough complete test of these many things would include making
a credit card payment - via Stripe.  This is awkward because you then
need to <u>refund</u> that payment on the Stripe dashboard.  Instead,
if the last name of the person <u>begins</u> with 'zz' (or 'Zz' or 'ZZ') then the
credit card payment will be skipped.  The “payment” will still be recorded
in Reg.  After the tests it is best to "clear the field" by deleting the
registration / payment / gift card / etc AND also delete the person.  If the
tests happen on the development machine akash2 it's not as critical to
do this clearing as the accounting office will not be trying to do a
reconciliation.  Note that you can search for all ZZ people by last name.

<h2>Gift Cards</h2>

	<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/gift_card1'>https://akash2.mountmadonna.org/cgi-bin/gift_card1</a>
<ul>
	gift_card1.tt2<br>
	gift_card2.tt2<br>
	gift_card_message.tt2 <span class=special>**</span><br>
	gift_card_email.tt2 <span class=special>**</span><br>

</ul>
<h2>Rental Grid</h2>

    Does this <i>really</i> need to be styled?  Maybe not.<br>
    Ask Sahadev and Lara and the DSG (Director of Guest Services).
<p>
	<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/grid?code=vbkxhf'>https://akash2.mountmadonna.org/cgi-bin/grid?code=vbkxhf</a>
<ul>
	grid.tt2<br>
	ram_conflict.tt2 <span class=special>**</span><br>
	need_email.tt2 <span class=special>**</span><br>
	ngrid.tt2<br>
	sgrid.tt2<br>
    grid_htype.tt2 <span class=special>**</span> (this needs special handling)

</ul>
<h2>Rental Payments (deposit, invoice)</h2>

	<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/rental_payment?code=vbkxhf&type=deposit'>https://akash2.mountmadonna.org/cgi-bin/rental_payment?code=vbkxhf&type=deposit </a>
    <p>
	<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/rental_payment?code=vbkxhf&type=invoice'>https://akash2.mountmadonna.org/cgi-bin/rental_payment?code=vbkxhf&type=invoice</a>
    <ul>
	rental_payment.tt2<br>
	rental_payment_message.tt2 <span class=special>**</span><br>

</ul>
<h2>Personal Retreats</h2>

	<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/regPR'>https://akash2.mountmadonna.org/cgi-bin/regPR</a>
    <ul>
	regpr.tt2<br>
	reg1.tt2<br>
	reg2.tt2<br>
	err.tt2 <span class=special>**</span><br>
	reg_message.tt2 <span class=special>**</span><br>
    kayakalpa.tt2 <span class=special>**</span><br>
    kayakalpa2.tt2 <span class=special>**</span>
</ul>
<h2>Program Registration</h2>
	Program registrations follow a similar path to PRs but without the initial PR page.
    <ul>
	reg1.tt2<br>
	reg2.tt2<br>
	err.tt2 <span class=special>**</span><br>
	reg_message.tt2 <span class=special>**</span><br>
    kayakalpa.tt2 <span class=special>**</span><br>
    kayakalpa2.tt2 <span class=special>**</span>
    </ul>
    <p>
    Here are two examples - with differing configurations:
    <p>
    Reg By Day, Covid Vax required, Alert message at top<br>
    <a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/reg1?id=4823'>https://akash2.mountmadonna.org/cgi-bin/reg1?id=4823</a>
    <p>
    Sliding Scale Donation<br>
    <a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/reg1?id=4824'>https://akash2.mountmadonna.org/cgi-bin/reg1?id=4824</a>

<p>
The following two templates are special.  Ask Sahadev.
<p>
A meal information page linked from meal requests and registrations:<br>
/var/www/src/root/static/meals_at_mmc.html
<p>
The registration confirmation letter:<br>
/var/www/src/root/static/templates/letter/default.tt2
<p>
</ul>
<h2>Mountain Experience</h2>

MEs are similar to PRs.
<p>
	<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/regME'>https://akash2.mountmadonna.org/cgi-bin/regME</a>
    <ul>

	regme.tt2<br>
	reg1.tt2<br>
	reg2.tt2<br>
	err.tt2 <span class=special>**</span><br>
	reg_message.tt2 <span class=special>**</span><br>
    kayakalpa.tt2 <span class=special>**</span><br>
    kayakalpa2.tt2 <span class=special>**</span>
</ul>
<h2>Meal Requests</h2>
<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/meal_request'>https://akash2.mountmadonna.org/cgi-bin/meal_request</a>
<ul>
meal_request.tt2<br>
meal_request2.tt2<br>
meal_request_receipt.tt2 <span class=special>**</span><br>
mr_err.tt2 <span class=special>**</span>
<p>
There is also a linked page to be styled separately:<br>
/static/meals_at_mmc.html
</ul>

<h2>Program Inquiry</h2>
<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/program_inquiry.pl'>https://akash2.mountmadonna.org/cgi-bin/program_inquiry.pl</a>
<ul>
program_inquiry1.tt2<br>
program_inquiry2.tt2 <span class=special>**</span><br>
program_inquiry3.tt2 <span class=special>**</span><br>
</ul>
<h2>New HFS Membership</h2>

	<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/new_hfs_member'>https://akash2.mountmadonna.org/cgi-bin/new_hfs_member</a>
    <ul>

	new_hfs_member.tt2 <span class=special>**</span><br>
	new_hfs_member2.tt2 <span class=special>**</span><br>
	new_hfs_email.tt2 <span class=special>**</span><br>
	member_message.tt2 <span class=special>**</span>

</ul>
<h2>Renewing HFS Membership</h2>

	<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/omp?code=hnawdp'>https://akash2.mountmadonna.org/cgi-bin/omp?code=hnawdp</a>
    <ul>

	omp.tt2<br>

</ul>
<h2>MMI Mailing List</h2>

	<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/mlist'>https://akash2.mountmadonna.org/cgi-bin/mlist</a>
    <ul>

	mlist.tt2<br>
	mlist_msg.tt2 <span class=special>**</span><br>

</ul>
<h2>Requested Payments for registrations</h2>

    <a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/req_pay?code=vszgxx'>https://akash2.mountmadonna.org/cgi-bin/req_pay?code=vszgxx</a>
    <ul>

	req_pay.tt2<br>
	req_pay_message.tt2 <span class=special>**</span>
<p>
If this payment is tested through to completion
it cannot be done again.  A new code will have to be generated.
Ask Sahadev.
</ul>

<h2>Request COVID Vaccination Card</h2>
    <a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/covid_vax?person_id=268849&name=Jon%20Bjornstad'>https://akash2.mountmadonna.org/cgi-bin/covid_vax?person_id=268849&name=Jon%20Bjornstad</a>
    <ul>
    covid_vax.tt2<br>
    covid_thanks.tt2 <span class=special>**</span>
    </ul>

<h2>Distributed Data Update</h2>

A way to have people in the database keep their own
demographic information (phone, address, email) up to date.
This has never been used.
<p>
<a target=_blank href='https://akash2.mountmadonna.org/cgi-bin/update?code=ibezaq'>https://akash2.mountmadonna.org/cgi-bin/update?code=ibezaq</a>
<ul>
update.tt2 <span class=special>**</span><br>
update2.tt2 <span class=special>**</span>
</ul>

<h2>Daily Sutra</h2>
    <a target=_blank href='https://akash2.mountmadonna.org/sutra'>https://akash2.mountmadonna.org/sutra</a>
    <p>
    This leads to a page where one can sign up for a daily Sutra from Babaji
    by email.  And where you can peruse the many sutras in a variety
    of ways.
    <ul>
    sutra.tt2 <span class=special>**</span>
    </ul>
<h2>Talks With Babaji</h2>
    <a target=_blank href='https://akash2.mountmadonna.org/talks'>https://akash2.mountmadonna.org/talks</a>
    <p>
    The text for these talks is kept in a database on akash.<br>
    The pages are generated by a script.<br>
    On the index page there is a search function as well.
</body>
</html>
